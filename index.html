<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Extrair Vagas</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <div class="container">
    <div class="block">
      <h2>Mensagem Inicial:</h2>
      <textarea id="input-msg-start">Antes de tudo, obrigado pelo interesse em se integrar Ã  equipe, vagas disponÃ­veis:</textarea> 
    </div>

    <div class="block">
      <h2>Mensagem Final:</h2>
      <textarea id="input-msg-end">Qual das vagas acima deseja se candidatar?</textarea> 
    </div>

    <div class="block">
      <h2>Cole o HTML aqui:</h2>
      <textarea id="inputHTML"></textarea> 
      <button onclick="extrairVagas()">GERAR</button>
    </div>

    <div class="block">
      <h2>Vagas Formatadas:</h2>
      <textarea id="mensagem" readonly></textarea>
      <button onclick="copiarTexto()">COPIAR</button>
    </div>

  </div>

<script>
    function extrairVagas() {
      const html = document.getElementById('inputHTML').value;
      const parser = new DOMParser();
      const doc = parser.parseFromString(html, 'text/html');

      const msgStart = document.getElementById('input-msg-start').value;
      const msgEnd = document.getElementById('input-msg-end').value;

      const linhas = doc.querySelectorAll('tr.an-linha-grid');
      let textoVagas = msgStart + '\n\n';

      let contador = 1;

      linhas.forEach(linha => {
        let descVaga = linha.querySelector('.an-coluna-DESVAG')?.textContent.trim() || '';
        let numVagasRaw = linha.querySelector('.an-coluna-NUMVAG')?.textContent.trim() || '';

        let numVagas = numVagasRaw.replace(/Qtd:\s*/i, '').replace(/[^\d]/g, '');
        descVaga = descVaga.replace(/ðŸ”¶/g, '').trim();

        if (descVaga && numVagas !== '') {
          textoVagas += `ðŸ”¶ ${contador}. ${descVaga} (${numVagas})\n`;
          contador++;
        }
      });

      textoVagas += '\n' + msgEnd;
      document.getElementById('mensagem').value = textoVagas;
    }

    function copiarTexto() {
      const mensagem = document.getElementById('mensagem');
      mensagem.select();
      mensagem.setSelectionRange(0, 99999);
      navigator.clipboard.writeText(mensagem.value);
      alert('Texto copiado para a Ã¡rea de transferÃªncia!');
    }
</script>

</body>
</html>
